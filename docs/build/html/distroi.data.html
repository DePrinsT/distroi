<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>distroi.data package &mdash; DISTROI  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
      <link rel="stylesheet" href="_static/fonts.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="distroi.fitting package" href="distroi.fitting.html" />
    <link rel="prev" title="distroi.auxiliary package" href="distroi.auxiliary.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/distroi_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="distroi.html">distroi package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="distroi.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="distroi.auxiliary.html">distroi.auxiliary package</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">distroi.data package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-distroi.data.image">distroi.data.image module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-distroi.data.oi_container">distroi.data.oi_container module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-distroi.data.sed">distroi.data.sed module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="distroi.fitting.html">distroi.fitting package</a></li>
<li class="toctree-l3"><a class="reference internal" href="distroi.model.html">distroi.model package</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DISTROI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="distroi.html">distroi package</a></li>
      <li class="breadcrumb-item active">distroi.data package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/distroi.data.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-distroi.data">
<span id="distroi-data-package"></span><h1>distroi.data package<a class="headerlink" href="#module-distroi.data" title="Permalink to this headline"></a></h1>
<p>Subpackage providing the implementation of the supported types of data (i.e. optical interferometry data, 
spectral enery distribution, etc.). Data can be either observed, or calculated from the model.
In order to assure symmetry between these two cases, the source code makes no differentiation between the two.</p>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-distroi.data.image">
<span id="distroi-data-image-module"></span><h2>distroi.data.image module<a class="headerlink" href="#module-distroi.data.image" title="Permalink to this headline"></a></h2>
<p>Defines a class and the corresponding methods to handle images and their fast fourier transform.</p>
<dl class="py class">
<dt class="sig sig-object py" id="distroi.data.image.Image">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">distroi.data.image.</span></span><span class="sig-name descname"><span class="pre">Image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spc_dep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="distroi.model.dep.html#distroi.model.dep.spec_dep.SpecDep" title="distroi.model.dep.spec_dep.SpecDep"><span class="pre">distroi.model.dep.spec_dep.SpecDep</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#distroi.data.image.Image" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class containing information on an image and (optionally) its Fast Fourier Transform (FFT).</p>
<p>Contains all properties in order to fully describe both the image and its FFT. Note that all these properties are
expected if all class methods are to work. It can easily be generalized to different RT codes by defining a
corresponding image reader function analogous to ‘read_image_fft_mcfost’. Can handle any amount of pixels
in an image, as long as the amount of pixels in each dimension is even.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dictionary</strong> (<em>dict</em>) – Dictionary containing keys and values representing several instance variables described
below. Should include ‘wavelength’, ‘pixelscale_x’/’y’, ‘num_pix_x’/’y’, ‘img’, and ‘ftot’. The other required
instance variables (related to the FFT) are set automatically through perform_fft().</p></li>
<li><p><strong>spc_dep</strong> (<a class="reference internal" href="distroi.model.dep.html#distroi.model.dep.spec_dep.SpecDep" title="distroi.model.dep.spec_dep.SpecDep"><em>SpecDep</em></a>) – Optional spectral dependence of the image. This will only be used if this Image
is used on its own in methods calculating interferometric observables. If instead multiple Image object or
an SED are passed along as well, this property of the image will be ignored. By default, the spectral
dependency will be assumed to be flat in correlated flux accross wavelengths (note that flatness in correlated
flux means a spectral dependency ~ wavelength ^ -2 for F_lam).</p></li>
<li><p><strong>padding</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – Number of (x, y)-pixles to which an image should be 0-padded before performing
the FFT. I.e. padding=(680, 540) will 0-pad an image to 680 and 540 pixels in the x and y dimensions,
respectively. If smaller than the number of pixels already in the ‘img’ array, no padding will be added in
the respective dimension. These should both be even numbers!</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>wavelength</strong> (<em>float</em>) – Image wavelength in micron.</p></li>
<li><p><strong>pixelscale_x</strong> (<em>float</em>) – Pixelscale in radian in x (East-West) direction.</p></li>
<li><p><strong>pixelscale_y</strong> (<em>float</em>) – Pixelscale in radian in y (North-South) direction.</p></li>
<li><p><strong>num_pix_x</strong> (<em>int</em>) – Amount of image pixels in the x direction.</p></li>
<li><p><strong>num_pix_y</strong> (<em>int</em>) – Amount of image pixels in the y direction.</p></li>
<li><p><strong>img</strong> (<em>np.ndarray</em>) – 2D numpy array containing the image flux in Jy. 1st index = image y-axis,
2nd index = image x-axis.</p></li>
<li><p><strong>ftot</strong> (<em>float</em>) – Total image flux in Jy</p></li>
<li><p><strong>spc_dep</strong> (<a class="reference internal" href="distroi.model.dep.html#distroi.model.dep.spec_dep.SpecDep" title="distroi.model.dep.spec_dep.SpecDep"><em>SpecDep</em></a>) – Optional spectral dependence of the image. Assumed flat in correlated flux (F_nu) by
default.</p></li>
<li><p><strong>fft</strong> (<em>np.ndarray</em>) – Complex 2D numpy FFT of img in Jy, i.e. in correlated flux formulation.</p></li>
<li><p><strong>num_pix_fft_x</strong> (<em>int</em>) – Amount of image FFT pixels in the x direction. This can be different
from num_pix_x due to padding.</p></li>
<li><p><strong>num_pix_fft_y</strong> (<em>int</em>) – Amount of image FFT pixels in the y direction. This can be different
from num_pix_y due to padding.</p></li>
<li><p><strong>w_x</strong> (<em>np.ndarray</em>) – 1D array with numpy FFT x-axis frequencies in units of 1/pixelscale_x.</p></li>
<li><p><strong>w_y</strong> (<em>np.ndarray</em>) – 1D array with numpy FFT y-axis frequencies in units of 1/pixelscale_y.</p></li>
<li><p><strong>uf</strong> (<em>np.ndarray</em>) – 1D array with FFT spatial x-axis frequencies in 1/radian, i.e. uf = w_x/pixelscale_x.</p></li>
<li><p><strong>vf</strong> (<em>np.ndarray</em>) – 1D array with FFT spatial y-axis frequencies in 1/radian, i.e. vf = w_y/pixelscale_y.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="distroi.data.image.Image.add_overresolved_flux">
<span class="sig-name descname"><span class="pre">add_overresolved_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#distroi.data.image.Image.add_overresolved_flux" title="Permalink to this definition"></a></dt>
<dd><p>Function that adds the effect of an overresolved flux component to the Image instance. This affects the
following instance variables: ‘img’, and ‘ftot’. The flux of the overresolved component is added to ‘img’,
spread uniformly accross all its pixels. The flux is also added to ‘ftot’. Note that the complex visibilities
in ‘fft’ remain unaffected. This is the exact, analytical formulation of infinitely extended flux,
where the correlated flux of such a component is a direct delta at frequency 0. In this regime ad using the
FFT, only ‘ftot’ is increased, while ‘fft’ remains unaffected. This only has an effect on (squared)
visibilities if they are normalized. If they are expressed in correlated flux, this addition will have no
effect. Note that this function causes a discrepancy between ‘fft’ and ‘img’, as the addition to the former
assumes an infinitely extended uniform flux, while addition to the latter is spread over the finite image
size. The addition to ‘img’ serves more for visualization, e.g. the plots created by fft_diagonstic_plot().
As a result, be careful with future invocations of perform_fft(), the effect may not be as desired!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>flux</strong> (<em>float</em>) – The flux value (in Jy) of the overresolved component at the wavelength of the Image
instance.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="distroi.data.image.Image.add_point_source">
<span class="sig-name descname"><span class="pre">add_point_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#distroi.data.image.Image.add_point_source" title="Permalink to this definition"></a></dt>
<dd><p>Function that adds the effect of an additional point source to the Image instance. This affects the
following instance variables: ‘img’, ‘ftot’ and ‘fft’. The flux of the point source is added to the pixel in
‘img’ closest to the specified source position as well as to the value of ftot. ‘fft’ is modified by the
analytical addition of the point-source’s complex correlated flux. Note that, after this function is called,
there is thus a mismatch between ‘fft’ and ‘img’, since the effect of the source is added in an exact
analytic manner in the former while it is added aproximately in the latter. For example, nothing prevents the
addition of a point source far outside the image axes ranges. The addition to ‘fft’ will be analytically exact,
while the point source flux will be added to the nearest border pixel in ‘img’. The addition to ‘img’ serves
more for visualization, e.g. the plots created by fft_diagonstic_plot(). As a result, be careful with future
invocations of perform_fft(), the effect may not be as desired!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> (<em>float</em>) – The flux value (F_nu, in Jy) of the point source at the wavelength of the Image instance.</p></li>
<li><p><strong>coords</strong> (<em>tuple</em><em>(</em><em>float</em><em>)</em>) – 2D tuple giving the x and y position of the point source (in milli-arcsecond).
The positive x direction is towards the East. The positive y direction is towards the North.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="distroi.data.image.Image.diagnostic_plot">
<span class="sig-name descname"><span class="pre">diagnostic_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_vistype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'vis2'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'vis'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'fcorr'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vis2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_plotv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_ploti</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#distroi.data.image.Image.diagnostic_plot" title="Permalink to this definition"></a></dt>
<dd><p>Makes diagnostic plots showing both the model image and the FFT (squared) visibilities and complex phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig_dir</strong> (<em>str</em>) – Directory to store plots in.</p></li>
<li><p><strong>plot_vistype</strong> (<em>str</em>) – Sets the type of visibility to be plotted. ‘vis2’ for squared visibilities, ‘vis’
for visibilities or ‘fcorr’ for correlated flux in Jy.</p></li>
<li><p><strong>log_plotv</strong> (<em>bool</em>) – Set to True for a logarithmic y-scale in the (squared) visibility plot.</p></li>
<li><p><strong>log_ploti</strong> (<em>bool</em>) – Set to True for a logarithmic intensity scale in the model image plot.</p></li>
<li><p><strong>show_plots</strong> (<em>bool</em>) – Set to False if you do not want the plots to be shown during your script run.
Note that if True, this freazes further code execution until the plot windows are closed.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="distroi.data.image.Image.freq_info">
<span class="sig-name descname"><span class="pre">freq_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#distroi.data.image.Image.freq_info" title="Permalink to this definition"></a></dt>
<dd><p>Returns a string containing information on both the spatial frequency domain/sampling and the corresponding
projected baselines.</p>
<dl class="field-list simple">
<dt class="field-odd">Return info_str</dt>
<dd class="field-odd"><p>String containing frequency info which can be printed.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="distroi.data.image.Image.half_light_radius">
<span class="sig-name descname"><span class="pre">half_light_radius</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#distroi.data.image.Image.half_light_radius" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the half light radius of the image by adding up the fluxes of pixels within increasing circular
aperatures. If you want only the half light radius excluding the central source, e.g. the model disk in an
MCFOST model, one should exclude the central source when reading in the image file (e.g. using disk_only=True
with read_image_fft_mcfost()). Due to the implImageimentation, the returned value’s accuracy is inherently
limited by the model image pixelscale. Note also that the radius is calculated in the image plane, and thus
depends on e.g. inclination of the RT model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return hlr</dt>
<dd class="field-odd"><p>The half light radius in milli-arcseconds.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="distroi.data.image.Image.perform_fft">
<span class="sig-name descname"><span class="pre">perform_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#distroi.data.image.Image.perform_fft" title="Permalink to this definition"></a></dt>
<dd><p>Perform the numpy FFT and set the required properties related to the image’s FFT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>padding</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – Number of (x, y)-pixles to which an image should be 0-padded before performing
the FFT. I.e. padding=(680, 540) will 0-pad an image to 680 and 540 pixels in the x and y dimensions,
respectively. If smaller than the number of pixels already in the ‘img’ array, no padding will be added in
the respective dimension. These should both be even numbers!</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="distroi.data.image.Image.redden">
<span class="sig-name descname"><span class="pre">redden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ebminv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reddening_law</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'/home/toond/Documents/phd/python/distroi/utils/ISM_reddening/ISMreddening_law_Cardelli1989.dat'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#distroi.data.image.Image.redden" title="Permalink to this definition"></a></dt>
<dd><p>Further reddens the model image according to the approriate E(B-V) and a corresponding reddening law.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ebminv</strong> (<em>float</em>) – E(B-V) reddening factor to be applied.</p></li>
<li><p><strong>reddening_law</strong> (<em>str</em>) – Path to the reddening law to be used. Defaults to the ISM reddening law by
Cardelli (1989) in DISTROI’s ‘utils/ISM_reddening folder’. See this file for the expected formatting
of your own reddening laws.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="distroi.data.image.image_fft_comp_vis_interpolator">
<span class="sig-prename descclassname"><span class="pre">distroi.data.image.</span></span><span class="sig-name descname"><span class="pre">image_fft_comp_vis_interpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_ffts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#distroi.data.image.Image" title="distroi.data.image.Image"><span class="pre">distroi.data.image.Image</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalised</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">scipy.interpolate._rgi.RegularGridInterpolator</span></span></span><a class="headerlink" href="#distroi.data.image.image_fft_comp_vis_interpolator" title="Permalink to this definition"></a></dt>
<dd><p>Creates a scipy RegularGridInterpolator from model Image objects, which can be used to interpolate the complex
visibility to different spatial frequencies than those returned by the FFT algorithm and, optionally,
different wavelengths than those of the RT model images themselves. Note: The interpolator will throw errors if
arguments outside their bounds are supplied! Note: Expects, in case of multiple model images, that every image
included has the same pixelscale and amount of pixels (in both x- and y-direction).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_ffts</strong> (<em>list</em>) – List of Image objects to create an interpolator from. If the list has length one,
i.e. a monochromatic model for the emission, the returned interpolator can only take the 2 spatial frequencies
(units 1/Hz) as arguments. If the list contains multiple objects, i.e. a chromatic model for the emission,
the interpolator will also be able to take wavelength (in micron) as an argument and will be able to interpolate
along the wavelength dimension.</p></li>
<li><p><strong>normalised</strong> (<em>bool</em>) – Set to True if you want the returned interpolator to produce normalised, non-absolute
complex visibilities (for calculating e.g. squared visibilities). By default normalised = False, meaning
the interpolator returns absolute complex visibilities, i.e. complex correlated fluxes (in units Jy).</p></li>
<li><p><strong>interp_method</strong> (<em>str</em>) – Interpolation method used by the returned scipy RegularGridInterpolator.
Can support ‘linear’, ‘nearest’, ‘slinear’, ‘cubic’, ‘quintic’ or ‘pchip’.</p></li>
</ul>
</dd>
<dt class="field-even">Return interpolator</dt>
<dd class="field-even"><p>Interpolator for the model image FFTs. If len(img_ffts) == 1, only takes the uv spatial
frequencies (units 1/rad) as arguments as follows: interpolator(v, u).  If len(img_ffts) &gt; 1, then it also
can interpolate between wavelengths (units micron) as follows: interpolator(wavelength, v, u).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>scipy.interpolate.RegularGridInterpolator</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="distroi.data.image.image_fft_ftot_interpolator">
<span class="sig-prename descclassname"><span class="pre">distroi.data.image.</span></span><span class="sig-name descname"><span class="pre">image_fft_ftot_interpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_ffts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#distroi.data.image.Image" title="distroi.data.image.Image"><span class="pre">distroi.data.image.Image</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">scipy.interpolate._interpolate.interp1d</span></span></span><a class="headerlink" href="#distroi.data.image.image_fft_ftot_interpolator" title="Permalink to this definition"></a></dt>
<dd><p>Creates a scipy interp1d object from a list of model Image objects, allowing to interpolate the total
flux (F_nu format in unit Jansky) along the wavelength dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_ffts</strong> (<em>list</em>) – List of Image objects to create an interpolator from. Must have length longer than one.</p></li>
<li><p><strong>interp_method</strong> (<em>str</em>) – Interpolation method used by scipy’s interp1d method. Defualt is ‘linear’.
Can support ‘linear’, ‘nearest’, ‘nearest-up’, ‘zero’, ‘slinear’, ‘quadratic’, ‘cubic’, ‘previous’, or
‘next’.</p></li>
</ul>
</dd>
<dt class="field-even">Return interpolator</dt>
<dd class="field-even"><p>Interpolator for the total flux in F_nu format and units Jy. Takes the wavelength in micron
as its only argument.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>scipy.interpolate.interp1d</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="distroi.data.image.read_image_list">
<span class="sig-prename descclassname"><span class="pre">distroi.data.image.</span></span><span class="sig-name descname"><span class="pre">read_image_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mod_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'mcfost'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mcfost'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebminv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reddening_law</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'/home/toond/Documents/phd/python/distroi/utils/ISM_reddening/ISMreddening_law_Cardelli1989.dat'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#distroi.data.image.Image" title="distroi.data.image.Image"><span class="pre">distroi.data.image.Image</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#distroi.data.image.read_image_list" title="Permalink to this definition"></a></dt>
<dd><p>Function that takes the path to an RT model’s directory and a subdirectory containing image files, and returns a
list of Image objects representing those model images. They should thus represent the same underlying physical
model, but imaged at different wavelengths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mod_dir</strong> (<em>str</em>) – Parent directory of the RT model of interest.</p></li>
<li><p><strong>img_dir</strong> (<em>str</em>) – Subdirectory containing RT model images. All image files recursively found in the subdirectories
of ‘mod_dir+img_dir’ are read.</p></li>
<li><p><strong>read_method</strong> (<em>str</em>) – Type of method used to read in RT model images when creating Image class instances.
Currently only supports ‘mcfost’, in which case all files ending on the sufix ‘RT.fits.gz’ are read in.</p></li>
<li><p><strong>padding</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – Number of (x, y)-pixles to which an image should be 0-padded before performing
the FFT. I.e. padding=(680, 540) will 0-pad an image to 680 and 540 pixels in the x and y dimensions,
respectively. If smaller than the number of pixels already in the ‘img’ array, no padding will be added in
the respective dimension. These should both be even numbers!</p></li>
<li><p><strong>ebminv</strong> (<em>float</em>) – E(B-V) of additional reddening to be applied to the model images. Only useful if
the visibilities need to be expressed in correlated flux at some point.</p></li>
<li><p><strong>reddening_law</strong> (<em>str</em>) – Path to the reddening law to be used. Defaults to the ISM reddening law by
Cardelli (1989) in DISTROI’s ‘utils/ISM_reddening folder’. See this file for the expected formatting
of your own reddening laws.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>img_ffts: List of Image objects representing all model image files found under ‘mod_dir+img_dir’.
Sorted by wavelength</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list(<a class="reference internal" href="#distroi.data.image.Image" title="distroi.data.image.Image">Image</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="distroi.data.image.read_image_mcfost">
<span class="sig-prename descclassname"><span class="pre">distroi.data.image.</span></span><span class="sig-name descname"><span class="pre">read_image_mcfost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disk_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#distroi.data.image.Image" title="distroi.data.image.Image"><span class="pre">distroi.data.image.Image</span></a></span></span><a class="headerlink" href="#distroi.data.image.read_image_mcfost" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve image data from an MCFOST model image and return it as an Image class instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_path</strong> (<em>str</em>) – Path to an MCFOST output RT.fits.gz model image file.</p></li>
<li><p><strong>padding</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – Number of (x, y)-pixles to which an image should be 0-padded before performing
the FFT. I.e. padding=(680, 540) will 0-pad an image to 680 and 540 pixels in the x and y dimensions,
respectively. If smaller than the number of pixels already in the ‘img’ array, no padding will be added in
the respective dimension. These should both be even numbers!</p></li>
<li><p><strong>disk_only</strong> (<em>bool</em>) – Set to True if you only want to read in the flux from the disk.</p></li>
</ul>
</dd>
<dt class="field-even">Return image</dt>
<dd class="field-even"><p>Image instance containing the information on the MCFOST RT image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#distroi.data.image.Image" title="distroi.data.image.Image">Image</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-distroi.data.oi_container">
<span id="distroi-data-oi-container-module"></span><h2>distroi.data.oi_container module<a class="headerlink" href="#module-distroi.data.oi_container" title="Permalink to this headline"></a></h2>
<p>Contains a class to store optical inteferometric (OI) observables and additional functions to take radiative
transfer (RT) model images and convert them to interferometric observables at the spatial frequencies of data
stored in the OIFITS format. Currently supports the following combinations of obsevrables: Squared visibilities -
Closure phases ; Visibilities - Closure phases ; Correlated fluxes (formaly stored as visibilities) - Closure phases.</p>
<dl class="py class">
<dt class="sig sig-object py" id="distroi.data.oi_container.OIContainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">distroi.data.oi_container.</span></span><span class="sig-name descname"><span class="pre">OIContainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcorr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#distroi.data.oi_container.OIContainer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to contain optical interferometry observables, where each observable is stored in the form of raveled 1D
numpy arrays. Based on the Data class in ReadOIFITS.py, where the observables are stored per OIFITS table,
but the raveled form makes calculations easier and less prone to error. Currenlty supports visibilities (both in
normalized and correlated flux form), squared visibilities and closure phases. In this format this class and the
methods below can be expanded to accomodate for different kinds of observables (i.e. addition of differential
visibilities). Can contain observables either related to astronomical observations or model RT images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dictionary</strong> (<em>dict</em>) – Dictionary containing keys and values representing all instance variables described below
(excluding fcorr).</p></li>
<li><p><strong>fcorr</strong> (<em>bool</em>) – Set to True if the visibilities are to be stored as correlated fluxes in Jy.</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>vis_in_fcorr</strong> (<em>bool</em>) – Whether visibilities are stored in correlated flux or not.</p></li>
<li><p><strong>v_uf</strong> (<em>np.ndarray</em>) – u-axis spatial freqs in 1/rad for visibility data.</p></li>
<li><p><strong>v_vf</strong> (<em>np.ndarray</em>) – v-axis spatial freqs in 1/rad for visibility data.</p></li>
<li><p><strong>v_wave</strong> (<em>np.ndarray</em>) – Wavelengths in micron for visibility data.</p></li>
<li><p><strong>v</strong> (<em>np.ndarray</em>) – Visibilities, either normalized visibilities or correlated flux in Janksy.</p></li>
<li><p><strong>v_err</strong> (<em>np.ndarray</em>) – Error on visibilities.</p></li>
<li><p><strong>v_base</strong> (<em>np.ndarray</em>) – Baseline length in MegaLambda for visibility data.</p></li>
<li><p><strong>v2_uf</strong> (<em>np.ndarray</em>) – u-axis spatial freqs in 1/rad for squared visibility data.</p></li>
<li><p><strong>v2_vf</strong> (<em>np.ndarray</em>) – v-axis spatial freqs in 1/rad for squared visibility data.</p></li>
<li><p><strong>v2_wave</strong> (<em>np.ndarray</em>) – Wavelengths in micron for squared visibility data.</p></li>
<li><p><strong>v2</strong> (<em>np.ndarray</em>) – Squared visibilities.</p></li>
<li><p><strong>v2_err</strong> (<em>np.ndarray</em>) – Error on squared visibilities.</p></li>
<li><p><strong>v2_base</strong> (<em>np.ndarray</em>) – Baseline length in MegaLambda for squared visibility data.</p></li>
<li><p><strong>t3_uf1</strong> (<em>np.ndarray</em>) – u-axis spatial freqs in 1/rad for the 1st projected baseline along the closure triangle.</p></li>
<li><p><strong>t3_vf1</strong> (<em>np.ndarray</em>) – v-axis spatial freqs in 1/rad for the 1st projected baseline along the closure triangle.</p></li>
<li><p><strong>t3_uf2</strong> (<em>np.ndarray</em>) – u-axis spatial freqs in 1/rad for the 2nd projected baseline along the closure triangle.</p></li>
<li><p><strong>t3_vf2</strong> (<em>np.ndarray</em>) – v-axis spatial freqs in 1/rad for the 2nd projected baseline along the closure triangle.</p></li>
<li><p><strong>t3_uf3</strong> (<em>np.ndarray</em>) – u-axis spatial freqs in 1/rad for the 3d projected baseline along the closure triangle.</p></li>
<li><p><strong>t3_vf3</strong> (<em>np.ndarray</em>) – v-axis spatial freqs in 1/rad for the 3d projected baseline along the closure triangle.</p></li>
<li><p><strong>t3_wave</strong> (<em>np.ndarray</em>) – Wavelengths in micron for closure phase data.</p></li>
<li><p><strong>t3phi</strong> (<em>np.ndarray</em>) – Closure phases in degrees.</p></li>
<li><p><strong>t3phi_err</strong> (<em>np.ndarray</em>) – Error on closure phases.</p></li>
<li><p><strong>t3_bmax</strong> (<em>np.ndarray</em>) – Maximum baseline length along the closure triangle in units of MegaLambda.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="distroi.data.oi_container.OIContainer.plot_data">
<span class="sig-name descname"><span class="pre">plot_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_plotv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_vistype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'vis2'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'vis'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'fcorr'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vis2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#distroi.data.oi_container.OIContainer.plot_data" title="Permalink to this definition"></a></dt>
<dd><p>Plots the data included in the OIContainer instance. Currently, plots uv coverage, a (squared) visibility curve
and closure phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig_dir</strong> (<em>str</em>) – Directory to store plots in.</p></li>
<li><p><strong>log_plotv</strong> (<em>bool</em>) – Set to True for a logarithmic y-scale in the (squared) visibility plot.</p></li>
<li><p><strong>plot_vistype</strong> (<em>str</em>) – Sets the type of visibility to be plotted. ‘vis2’ for squared visibilities or ‘vis’
for visibilities (either normalized or correlated flux in Jy, as implied by the OIContainer objects).</p></li>
<li><p><strong>show_plots</strong> (<em>bool</em>) – Set to False if you do not want the plots to be shown during your python instance.
Note that if True, this freazes further code execution until the plot windows are closed.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="distroi.data.oi_container.oi_container_calc_image_fft_observables">
<span class="sig-prename descclassname"><span class="pre">distroi.data.oi_container.</span></span><span class="sig-name descname"><span class="pre">oi_container_calc_image_fft_observables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">container_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#distroi.data.oi_container.OIContainer" title="distroi.data.oi_container.OIContainer"><span class="pre">distroi.data.oi_container.OIContainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_ffts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#distroi.data.image.Image" title="distroi.data.image.Image"><span class="pre">distroi.data.image.Image</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_sed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><span class="pre">distroi.data.sed.SED</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom_comps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="distroi.model.geom_comp.html#distroi.model.geom_comp.geom_comp.GeomComp" title="distroi.model.geom_comp.geom_comp.GeomComp"><span class="pre">distroi.model.geom_comp.geom_comp.GeomComp</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom_comp_flux_fracs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#distroi.data.oi_container.OIContainer" title="distroi.data.oi_container.OIContainer"><span class="pre">distroi.data.oi_container.OIContainer</span></a></span></span><a class="headerlink" href="#distroi.data.oi_container.oi_container_calc_image_fft_observables" title="Permalink to this definition"></a></dt>
<dd><p>Loads in OI observables from an OIContainer, and calculates corresponding model image observables. The model images
are passed along as a list of Image objects.</p>
<p>If this list contains one object, the normalized visibilities will not be interpolated in the wavelength dimension,
i.e. the emission morphology is ‘monochromatic’. If the list contains multiple Image objects, interpolation in
wavelength is performed. In this case the wavelength coverage of the Image objects needs to exceed that of the
OIContainer!</p>
<p>NOTE: This method expects that every Image object in the list has the same pixelscale and amount of pixels
(in both x- and y-direction).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>container_data</strong> (<a class="reference internal" href="#distroi.data.oi_container.OIContainer" title="distroi.data.oi_container.OIContainer"><em>OIContainer</em></a>) – OIContainer at whose spatial frequencies we calculate model observables.</p></li>
<li><p><strong>img_ffts</strong> – List of Image objects representing the RT model images at different wavelengths. If containing
only one object, no interpolation of the normalized visibilities in the wavelength dimension will be performed.</p></li>
<li><p><strong>img_sed</strong> (<a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><em>SED</em></a>) – Optional SED to be passed along defining the total flux wavelength dependence of the model
Image(s). By default, this is None, and the total flux wavelength dependence will be taken from either
the SpecDep property of the Image, in case img_ffts contains a single Image object, or from
a linear interpolation between the total fluxes in case img_ffts contains multiple Image objects.</p></li>
<li><p><strong>geom_comps</strong> (<em>list</em><em>[</em><a class="reference internal" href="distroi.model.geom_comp.html#distroi.model.geom_comp.geom_comp.GeomComp" title="distroi.model.geom_comp.geom_comp.GeomComp"><em>GeomComp</em></a><em>]</em>) – Optional list of GeomComp objects, representing geometric components to be added
to the complex visibility calculation.</p></li>
<li><p><strong>geom_comp_flux_fracs</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Flux fractions of the geometric components. Should add up to less than one.
The remainder from the difference with one will be the flux fraction attributed to the model image(s).</p></li>
<li><p><strong>ref_wavelength</strong> (<em>float</em>) – Reference wavelength for the geometric component flux fractions in micron. In case
image_ffts contains more than one model image. This wavelength must lie within the wavelength range spanned by
the SED (if passed along), or by the model images.</p></li>
<li><p><strong>interp_method</strong> (<em>str</em>) – Interpolation method used by scipy to perform interpolations. Can support ‘linear’,
‘nearest’, ‘slinear’, or ‘cubic’.</p></li>
</ul>
</dd>
<dt class="field-even">Return container_mod</dt>
<dd class="field-even"><p>OIContainer for model image observables.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#distroi.data.oi_container.OIContainer" title="distroi.data.oi_container.OIContainer">OIContainer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="distroi.data.oi_container.oi_container_plot_data_vs_model">
<span class="sig-prename descclassname"><span class="pre">distroi.data.oi_container.</span></span><span class="sig-name descname"><span class="pre">oi_container_plot_data_vs_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">container_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#distroi.data.oi_container.OIContainer" title="distroi.data.oi_container.OIContainer"><span class="pre">distroi.data.oi_container.OIContainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">container_mod</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#distroi.data.oi_container.OIContainer" title="distroi.data.oi_container.OIContainer"><span class="pre">distroi.data.oi_container.OIContainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_plotv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_vistype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'vis2'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'vis'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'fcorr'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vis2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#distroi.data.oi_container.oi_container_plot_data_vs_model" title="Permalink to this definition"></a></dt>
<dd><p>Plots the data against the model OI observables. Currently, plots uv coverage, a (squared) visibility curve and
closure phases. Note that this function shares a name with a similar function in the sed module. Take care with
your namespace if you use both functions in the same script.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>container_data</strong> (<a class="reference internal" href="#distroi.data.oi_container.OIContainer" title="distroi.data.oi_container.OIContainer"><em>OIContainer</em></a>) – Container with data observables.</p></li>
<li><p><strong>container_mod</strong> (<a class="reference internal" href="#distroi.data.oi_container.OIContainer" title="distroi.data.oi_container.OIContainer"><em>OIContainer</em></a>) – Container with model observables.</p></li>
<li><p><strong>fig_dir</strong> (<em>str</em>) – Directory to store plots in.</p></li>
<li><p><strong>log_plotv</strong> (<em>bool</em>) – Set to True for a logarithmic y-scale in the (squared) visibility plot.</p></li>
<li><p><strong>plot_vistype</strong> (<em>str</em>) – Sets the type of visibility to be plotted. ‘vis2’ for squared visibilities, ‘vis’
for visibilities or ‘fcorr’ for correlated flux in Jy.</p></li>
<li><p><strong>show_plots</strong> (<em>bool</em>) – Set to False if you do not want the plots to be shown during your python instance.
Note that if True, this freazes further code execution until the plot windows are closed.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="distroi.data.oi_container.read_oi_container_from_oifits">
<span class="sig-prename descclassname"><span class="pre">distroi.data.oi_container.</span></span><span class="sig-name descname"><span class="pre">read_oi_container_from_oifits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_lims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2lim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcorr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#distroi.data.oi_container.OIContainer" title="distroi.data.oi_container.OIContainer"><span class="pre">distroi.data.oi_container.OIContainer</span></a></span></span><a class="headerlink" href="#distroi.data.oi_container.read_oi_container_from_oifits" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve data from (multiple) OIFITS files and return in an OIConatiner class instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dir</strong> (<em>str</em>) – Path to the directory where the files are stored.</p></li>
<li><p><strong>data_file</strong> (<em>str</em>) – Data filename, including wildcards if needed to read in multiple files at once.</p></li>
<li><p><strong>wave_lims</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – The lower and upper wavelength limits in micron used when reading in data.</p></li>
<li><p><strong>v2lim</strong> (<em>float</em>) – Upper limit on the squared visibility used when reading in data.</p></li>
<li><p><strong>fcorr</strong> (<em>bool</em>) – Set to True if visibility data is to be interpreted as correlated fluxes in Jy units.</p></li>
</ul>
</dd>
<dt class="field-even">Return container</dt>
<dd class="field-even"><p>OIContainer with the observables from the OIFITS file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#distroi.data.oi_container.OIContainer" title="distroi.data.oi_container.OIContainer">OIContainer</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-distroi.data.sed">
<span id="distroi-data-sed-module"></span><h2>distroi.data.sed module<a class="headerlink" href="#module-distroi.data.sed" title="Permalink to this headline"></a></h2>
<p>Defines a class and the corresponding methods to load in and handle both observed and model spectral energy
distributions (SEDs).</p>
<dl class="py class">
<dt class="sig sig-object py" id="distroi.data.sed.SED">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">distroi.data.sed.</span></span><span class="sig-name descname"><span class="pre">SED</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#distroi.data.sed.SED" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class containing information on an SED. Can contain SED information either related to astronomical observations
or model RT images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dictionary</strong> (<em>dict</em>) – Dictionary containing keys and values representing several instance variables described
below. Should include ‘wavelengths’, ‘flam’, and ‘flam_err’. The other required instance variables are set
automatically through add_freq_vars().</p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>wavelengths</strong> (<em>np.ndarray</em>) – 1D array containing the wavelengths in micron.</p></li>
<li><p><strong>frequencies</strong> (<em>np.ndarray</em>) – 1D array containing the frequencies in Hz.</p></li>
<li><p><strong>flam</strong> (<em>np.ndarray</em>) – 1D array containing the flux in F_lam format, the unit is erg s^-1 cm^-2 micron^-1.</p></li>
<li><p><strong>flam_err</strong> (<em>np.ndarray</em>) – 1D array containing the errors on flam_err (set to 0 if reading in a model SED).</p></li>
<li><p><strong>fnu</strong> (<em>np.ndarray</em>) – 1D array containing the flux in F_nu format, the unit is Jansky (Jy).</p></li>
<li><p><strong>fnu_err</strong> (<em>np.ndarray</em>) – 1D array containing the error on F_nu.</p></li>
<li><p><strong>bands</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional list of strings containing the names of the associated photometric bands.
Mostly useful when reading in observed SED data tables from e.g. VizieR.</p></li>
<li><p><strong>sources</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Similar to the ‘bands’ attribute, but listing the source catalogue.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="distroi.data.sed.SED.add_freq_vars">
<span class="sig-name descname"><span class="pre">add_freq_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#distroi.data.sed.SED.add_freq_vars" title="Permalink to this definition"></a></dt>
<dd><p>Calculate and set frequency-based instance variables from the wavelength-based ones.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="distroi.data.sed.SED.get_flux">
<span class="sig-name descname"><span class="pre">get_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_form</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'flam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span></span><a class="headerlink" href="#distroi.data.sed.SED.get_flux" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve the flux at certain wavelengths/frequencies by interpolating the contained SED data. Note that this
method throws an error if you try to retrieve fluxes outside the wavelength/frequency bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em><em> | </em><em>float</em>) – Wavelengths/frequencies (in micron/Hz) at which to calculate the flux.</p></li>
<li><p><strong>flux_form</strong> (<em>str</em>) – The format of the flux to be calculated. Options are ‘flam’ (default) and ‘lam_flam’,
as well as their frequency analogues ‘fnu’ and ‘nu_fnu’. In case flux_form = ‘flam’ or ‘lam_flam’, x is
assumed to be wavelengths, while in case of ‘fnu’ and ‘nu_fnu’, x is assumed to be frequencies.</p></li>
<li><p><strong>interp_method</strong> (<em>str</em>) – Interpolation method used by scipy’s interp1d method. Defualt is ‘linear’.
Can support ‘linear’, ‘nearest’, ‘nearest-up’, ‘zero’, ‘slinear’, ‘quadratic’, ‘cubic’, ‘previous’, or
‘next’.</p></li>
</ul>
</dd>
<dt class="field-even">Return flux</dt>
<dd class="field-even"><p>The flux calculated at x using the reference wavelength/frequency and reference flux value.
In case of flux_form=’flam’, output will be in units erg s^-1 cm^-2 micron^-1. In case of
flux_form=’fnu’, output will be in units Jansky. In case of flux_form=’lam_flam’, units
will be in erg s^-1 cm^-2. In case of flux_form=’nu_fnu’, units will be Jy Hz</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray | float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="distroi.data.sed.SED.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_form</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lam_flam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#distroi.data.sed.SED.plot" title="Permalink to this definition"></a></dt>
<dd><p>Make a scatter plot of the SED.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="distroi.data.sed.SED.redden">
<span class="sig-name descname"><span class="pre">redden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ebminv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reddening_law</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'/home/toond/Documents/phd/python/distroi/utils/ISM_reddening/ISMreddening_law_Cardelli1989.dat'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#distroi.data.sed.SED.redden" title="Permalink to this definition"></a></dt>
<dd><p>Further reddens the SED according to the approriate E(B-V) and a corresponding reddening law.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ebminv</strong> (<em>float</em>) – E(B-V) reddening factor to be applied.</p></li>
<li><p><strong>reddening_law</strong> (<em>str</em>) – Path to the reddening law to be used. Defaults to the ISM reddening law by
Cardelli (1989) in DISTROI’s ‘utils/ISM_reddening folder’. See this file for the expected formatting
of your own reddening laws.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="distroi.data.sed.read_sed_mcfost">
<span class="sig-prename descclassname"><span class="pre">distroi.data.sed.</span></span><span class="sig-name descname"><span class="pre">read_sed_mcfost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sed_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">star_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><span class="pre">distroi.data.sed.SED</span></a></span></span><a class="headerlink" href="#distroi.data.sed.read_sed_mcfost" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve SED data from an MCFOST model SED and return it as an SED class instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sed_path</strong> (<em>str</em>) – Path to an MCFOST output sed_rt.fits.gz model SED file.</p></li>
<li><p><strong>star_only</strong> (<em>bool</em>) – Set to True if you only want to read in the flux from the star.</p></li>
</ul>
</dd>
<dt class="field-even">Return sed</dt>
<dd class="field-even"><p>SED instance containing the information on the MCFOST model SED. Note that the errors on the flux
‘flam_err’ are set to zero (since this is a model SED).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED">SED</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="distroi.data.sed.read_sed_repo_phot">
<span class="sig-prename descclassname"><span class="pre">distroi.data.sed.</span></span><span class="sig-name descname"><span class="pre">read_sed_repo_phot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sed_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_lims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><span class="pre">distroi.data.sed.SED</span></a></span></span><a class="headerlink" href="#distroi.data.sed.read_sed_repo_phot" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve observed SED data stored in a .phot file from the SED catalog presented in Kluska et al. 2022 (
A&amp;A, 658 (2022) A36). Such files are stored in the local system of KU Leuven’s Institute of Astronomy.
Return it as an SED class instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sed_path</strong> (<em>str</em>) – Path to an MCFOST output sed_rt.fits.gz model SED file.</p></li>
<li><p><strong>wave_lims</strong> (<em>tuple</em><em>(</em><em>float</em><em>)</em>) – The lower and upper wavelength limits in micron used when reading in data.</p></li>
</ul>
</dd>
<dt class="field-even">Return sed</dt>
<dd class="field-even"><p>SED instance containing the information on the MCFOST model SED.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED">SED</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="distroi.data.sed.sed_chi2reddened">
<span class="sig-prename descclassname"><span class="pre">distroi.data.sed.</span></span><span class="sig-name descname"><span class="pre">sed_chi2reddened</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sed_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><span class="pre">distroi.data.sed.SED</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sed_mod</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><span class="pre">distroi.data.sed.SED</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebminv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reddening_law</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'/home/toond/Documents/phd/python/distroi/utils/ISM_reddening/ISMreddening_law_Cardelli1989.dat'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#distroi.data.sed.sed_chi2reddened" title="Permalink to this definition"></a></dt>
<dd><p>Returns the chi2 between an RT model SED and an observed SED under a certain amount of additional reddening.
Note that this doesn’t actually redden any of the SED object class instances, only calculates the chi2 assuming the
model SED were to be reddened.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sed_obs</strong> (<a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><em>SED</em></a>) – Observed SED.</p></li>
<li><p><strong>sed_mod</strong> (<a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><em>SED</em></a>) – RT model SED.</p></li>
<li><p><strong>ebminv</strong> (<em>float</em>) – E(B-V) reddening factor to be applied.</p></li>
<li><p><strong>reddening_law</strong> (<em>str</em>) – Path to the reddening law to be used. Defaults to the ISM reddening law by
Cardelli (1989) in DISTROI’s ‘utils/ISM_reddening folder’. See this file for the expected formatting
of your own reddening laws.</p></li>
</ul>
</dd>
<dt class="field-even">Return chi2</dt>
<dd class="field-even"><p>The chi2 value between the reddened model SED and the observed SED.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="distroi.data.sed.sed_plot_data_vs_model">
<span class="sig-prename descclassname"><span class="pre">distroi.data.sed.</span></span><span class="sig-name descname"><span class="pre">sed_plot_data_vs_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sed_dat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><span class="pre">distroi.data.sed.SED</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sed_mod</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><span class="pre">distroi.data.sed.SED</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_form</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lam_flam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#distroi.data.sed.sed_plot_data_vs_model" title="Permalink to this definition"></a></dt>
<dd><p>Plots the data (observed) SED against the model SED. Note that this function shares a name with a similar function
in the oi_observables module. Take care with your namespace if you use both functions in the same script.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sed_dat</strong> (<a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><em>SED</em></a>) – Data SED. Typically corresponds to observations.</p></li>
<li><p><strong>sed_mod</strong> (<a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><em>SED</em></a>) – RT model SED.</p></li>
<li><p><strong>fig_dir</strong> (<em>str</em>) – Directory to store plots in.</p></li>
<li><p><strong>flux_form</strong> (<em>str</em>) – Format for the flux. By default, it is set to ‘lam_flam’, meaning we represent the flux in
lam*F_lam format (units erg s^-1 cm^-2). Analogously, other options are ‘flam’ (erg s^-1 cm^-2 micron^-1),
‘fnu’ (Jy) and ‘nu_fnu’ (Jy Hz).</p></li>
<li><p><strong>log_plot</strong> (<em>bool</em>) – Set to False if you want the plot axes to be in linear scale.</p></li>
<li><p><strong>show_plots</strong> (<em>bool</em>) – Set to False if you do not want the plots to be shown during your script run.
Note that if True, this freazes further code execution until the plot windows are closed.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="distroi.data.sed.sed_reddening_fit">
<span class="sig-prename descclassname"><span class="pre">distroi.data.sed.</span></span><span class="sig-name descname"><span class="pre">sed_reddening_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sed_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><span class="pre">distroi.data.sed.SED</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sed_mod</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><span class="pre">distroi.data.sed.SED</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebminv_guess</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redden_mod</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reddening_law</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'/home/toond/Documents/phd/python/distroi/utils/ISM_reddening/ISMreddening_law_Cardelli1989.dat'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#distroi.data.sed.sed_reddening_fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits an additional reddening E(B-V) value to make a model SED match up to an observed SED as much as possible. In
case of a successfull fit, the model SED is subsequently reddened according to the fitted value E(B-V) and the
chi2 value between model and observations is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sed_obs</strong> (<a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><em>SED</em></a>) – Observed SED.</p></li>
<li><p><strong>sed_mod</strong> (<a class="reference internal" href="#distroi.data.sed.SED" title="distroi.data.sed.SED"><em>SED</em></a>) – RT model SED.</p></li>
<li><p><strong>ebminv_guess</strong> (<em>float</em>) – Initial guess for the E(B-V) reddening factor.</p></li>
<li><p><strong>redden_mod</strong> – Redden the model SED according to the fitted value. Set to true
by default.</p></li>
<li><p><strong>reddening_law</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return tuple(ebminv_opt, chi2)</dt>
<dd class="field-even"><p>The optimal E(B-V) and corresponding chi2 value between the reddened model SED and
the observed SED.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple(float)</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="distroi.auxiliary.html" class="btn btn-neutral float-left" title="distroi.auxiliary package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="distroi.fitting.html" class="btn btn-neutral float-right" title="distroi.fitting package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Toon De Prins.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>